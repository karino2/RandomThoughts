とりあえずプログラム関連のメモを書くので[[技術的なメモ]]から。


## GraphGo

Javaアプレットでブログを書きながらちょっとずつ開発していて、途中で終わってそうだけれどその分シンプルで参考にはしやすそう。

- [作って遊ぼうJavaアプレット](http://www.nonkit.com/java.html) ブログの目次
  - [作って遊ぼうJavaアプレット - GraghGo v0.16](http://www.nonkit.com/java.files/GraphGo_0_16/index.html) たぶん最終版はこれか？
  - [作って遊ぼうJavaアプレット - グラフ理論を用いた囲碁 数式一覧](http://www.nonkit.com/equations.html) 数式がまとまっていて参考になる

JavaScript版

- [JavaScriptでどこでもプログラミング](http://www.nonkit.com/javascript/index.html)  目次
  - [JavaScriptでプログラミング - Simulator 0.6](http://www.nonkit.com/javascript/simulator06.html) 最新版はこれか？コウは判定してそう。最後のスコア判定は無さそう？

## 雑多なリンク

- [Fuego](https://fuego.sourceforge.net/)
- [GNU Go - GNU Project - Free Software Foundation (FSF)](https://www.gnu.org/software/gnugo/)
- [ligi/gobandroid: A Goban for Android](https://github.com/ligi/gobandroid) 昔のAndroid用。結構大掛かりでGnuGoとかをプラグインとして組み込めそう
   - [icehong/gobandroid: A Goban for Android](https://github.com/icehong/gobandroid/tree/master) 一応まぁまぁ最近のASでビルドしたっぽいfork、PR用に作られていて放置されている
- [lightvector/KataGo: GTP engine and self-play learning in Go](https://github.com/lightvector/KataGo?tab=readme-ov-file)
- [BadukAI](https://aki65.github.io/) Android用のアプリでkatagoやleelazeroが動くらしい。これでいいのかもしれない。でもソースは無さそう。
- [featurecat/lizzie: Lizzie - Leela Zero Interface](https://github.com/featurecat/lizzie/tree/master) Javaで書かれたleela zeroのGUIクライアント。これの移植をベースにしたいかもしれない。
- [pasky/michi: Minimalistic Go MCTS Engine](https://github.com/pasky/michi/tree/master) めちゃ小さいpython実装のMCTSエンジン。移植も出来そう。
- [Sabaki/docs/guides/engines.md at master · SabakiHQ/Sabaki](https://github.com/SabakiHQ/Sabaki/blob/master/docs/guides/engines.md) Sabaikiのエンジンの所にいろんなエンジンへのリンクがある。
- [sanderland/katrain: Improve your Baduk skills by training with KataGo!](https://github.com/sanderland/katrain) 弱いモードがある？あとで調べる

## 自分用のAnddroid版の囲碁アプリを作りたい

囲碁であそぼ、の修行編のlv3くらいでいいんだが、あれに検討をつけたい。
広告とか無くしょぼいのが動くくらいでいいので。

方針としては碁盤の基本的なアプリを作って、細かい所は既存のモデルを使えないかなぁ、と思っている。

### gobandroidいじり

- guavaとかをdependenciesに追加
- ライブラリを適当にアップデート
- AndoidManifests.xmlにGnuGoのサービスのqueryを追加

このくらいで動いた。検討出来ないのかな？

### katagoのNDKでのビルド

NDKでビルドしてみる。大変かしら？

まずは公式をgit clone。

```
$ git clone https://github.com/lightvector/KataGo.git
```

そしてndkのビルドをする。

```
$ export ANDROID_NDK_HOME=~/Library/Android/sdk/ndk/25.2.9519653
$ cd cpp
$ mkdir build
$ cmake . -B build -DCMAKE_TOOLCHAIN_FILE=${ANDROID_NDK_HOME}/build/cmake/android.toolchain.cmake -DCMAKE_BUILD_TYPE=Release -DANDROID_NATIVE_API_LEVEL=33 -DANDROID_NDK=${ANDROID_NDK_HOME} -DANDROID_ABI=armeabi-v7a -DUSE_BACKEND=EIGEN
```

Eigenが見つからんと言われた。
Eigenはヘッダだけinclude出来る場所に置けば良さそうだな。

ダウンロードはここか？

[Eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page#Download)

なんかhttpsじゃないんだが…

とりあえず3.4.0をダウンロードする。
そしてcpp/external下に置く。

```
cpp $ cd external
cpp/external $ tar xzvf eigen-3.4.0.tar.gz
# cpp/external/eigen-3.4.0が出来る
```

次にこれをCMakeLists.txtに加えればいいのか？

```
include_directories(external/eigen-3.4.0)
```

そしてfind_packageで怒られるのでコメントアウトしておく。

```
#    find_package(Eigen3 REQUIRED)
#    include_directories(SYSTEM ${EIGEN3_INCLUDE_DIRS})
 #   message(STATUS "Found Eigen3 at ${EIGEN3_INCLUDE_DIRS}")
 message(STATUS "Skip eigen3 package find")
```

なんかlibzipがないからself playはzipの結果書き出しが出来ないから出来ないよ、とか言われるがしないのでいいだろう。

ではビルド。

```
$ cd build
$ make -j 16
```

なんか以下のエラーが出た。

```
KataGo/cpp/core/sha2.cpp:205:2: error: Define BYTE_ORDER to be equal to either LITTLE_ENDIAN or BIG_ENDIAN
#error Define BYTE_ORDER to be equal to either LITTLE_ENDIAN or BIG_ENDIAN
```

まぁどうせlittle endianでいいんだが、CMakeだけにしておきたいな。という事でさっきのmessageの下に以下を追加。

```
    message(STATUS "Skip eigen3 package find")
    # NDK
    target_compile_definitions(katago PRIVATE BYTE_ORDER=1234)
    target_compile_definitions(katago PRIVATE LITTLE_ENDIAN=1234)
    target_compile_definitions(katago PRIVATE BIG_ENDIAN=4321)
```

これでビルド出来た。
ビルドした結果はexeになってしまっている気がするな。

```
build $ file katago
katago: ELF 32-bit LSB pie executable, ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /system/bin/linker, BuildID[sha1]=a209a1e7210ea98f1bebe78b6122bb0621b09b5d, with debug_info, not stripped
```

adb shellで動かしてみるか？

```
build $ export PATH=$PATH:~/Library/Android/sdk/platform-tools
build $ adb push katago /sdcard/temp/katago
build $ adb shell
penang:/ $ cd /sdcard/temp
penang:/sdcard/temp $ ./katago
/system/bin/sh: ./katago: can't execute: Permission denied
126|penang:/sdcard/temp $ chmod +x katago
penang:/sdcard/temp $ ./katago
/system/bin/sh: ./katago: can't execute: Permission denied
```

なんで？