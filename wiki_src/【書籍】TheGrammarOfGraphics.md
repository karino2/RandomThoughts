以前Dan Luuが、[Against essential and accidental complexity](https://danluu.com/essential-complexity/)で言及してたThe Grammar of Graphics。

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=karino203-22&language=ja_JP&o=9&p=8&l=as4&m=amazon&f=ifr&ref=as_ss_li_til&asins=B00HWUVHXK&linkId=0e7b53a6005ea66f8e781a7f8376e0e3"></iframe>

自分はSpringerの40%オフの時に買った。たまにもっと安いセールもやっているが、そういうのを待っているとなかなか買えないので、欲しいものがあれば40%オフくらいで買ってしまって良い気はしている。

一度挫折したが、[[【書籍】ggplot2、ElegantGraphicsForDataAnalysis]]を読み終わって理解を深めたので再チャレンジ。

なお、このページではThe Grammar of GraphicsをGoGと略す事もある。

## 2章

2.2から読み直し。

2.2の最後まで読む。最後のパイチャートの例が出ている。
今読んで曖昧に感じるのはCOORDの指定でdim2の意味する所（横にgenderで並べるという意味か？）と、ELEMENTのpositionの意味。
他は割と理解出来るな。

2.3を見るとpositionはaesの一種っぽいな。なるほど。

## 3章 Data

以前読んだ時は細部にとらわれて何を言いたいか全然分からなかったが、
今回はセクションのタイトルとグラフとspecification見て分らない所だけ見直す感じで読むと良く分かる。

MOLAP とかの話は飛ばす。積極的に飛ばしていかないとすぐ何を言ってるか分からなくなる本だよなぁ。

### 三章読み終わり、意外と分かるな

specificationのdataに着目して読んでいけば何書いてあるのかは良く分かるな。
一方で読む側が気をつけないと何言いたいのか分からなくなるのは、やはり記述が良くない気はする。
まぁ他が無いのだから読む側が頑張るしか無い訳だが。

### 四章のtransformも読んだ

要点だけ読むとそんな時間もかからないので四章も読んでしまった。
個々の変換の意味とかは置いといてTRANSで何するのか、を追うだけなら難しいことは無いね。

## 5章 Algebra

集合論的なcross, nest, blendの3つの演算の定義があって、これがなす代数の話が少し続く。

5.1.4から具体的なExpressionの話が始まって、algebraic formとorderというのが出てくる。
ようするに全部展開した上で、一番大きな項の次数に合うように1を掛けて揃えて、
それらが各座標を表す、という話のよう。なるほど。

ただ、`A*C/B` のorderは2と書いてある。nestはorderには含まれない、というのはいまいちよく分かってないな。
というかnestをよく分かっていない。

A/Bと書いた時、これはBがタグとして扱われるんだよな。
例えば複数のグラフのcolorとかがこれに相当すると思うんだよな。Aは線を表す集合でBがfacetじゃないが複数のAについてのタグになっているという。

5.1.4.2に優先順位がある。上から、以下のようになっている。

1. nest
2. cross
3. blend

5.2で具体例が出てくる。いや、先に書いてよ…

### 5.2.3のFigure 5.6の例がよく分からない

1980年と2000年で色を変えているが、color指定の所ではp1980+p2000となっていて、これがpop1980とどう対応しているかが分からない。

普通に考えればpop1980にはp1980のフィールドが、pop2000にはp2000のフィールドがある、とかそういう必要があると思うが、
別段そういう事は書いていない。

単純にpointに２つ項があればそれぞれ別の色に書く、というルールがあるのか？

### 5章はなかなかGrammarっぽくなってきた

5章は無駄に数学的で分かりにくい部分もあるけれど、
一方で数学的なわかりやすさもあって、この本に期待されていたような内容になってきた気はする。
意味の分からない所もあるけれど、3つの演算の組み合わせで過去にあったさまざまなグラフが記述出来る、
というのはこの本の一番重要な貢献とも思う。

あまりわかりやすくは書かれていないので読む側が適宜飛ばしたり戻ったりしながら重要な所を掴む必要がある。
それは本としての出来は悪いという事だと思うけれど、発明の本質的価値が高くて他の本で解説されていない事なので、
読むに値する事だとは思った。ggplot2本とは重視している所が違うのでこの本を読む価値はあると思う。

## 6章 スケール

序盤の定義は抽象的だが未定義の変数がいろいろ出てきていまいちちゃんと追う気が起こらないので、
6.1.3.1くらいまで読み進めると、具体例っぽいものが出てくる。

- nominal: 一対一で各要素がユニークなideintifierを持つ事、アルファベット順など
- ordinal: 何らかの順位に従って並べられたもの、並び順が重要で間の隙間の広さは重要では無い、ランキングなど
- interval: 間の隙間の広さが重要、原点は重要では無い、政府支出など
- ratio: 原点が重要となる。政体ごとにカウントした時のカウントの比など

これらのナイーブな分類が十分でない、として話は進むのだが、こうした具体例をもとに話を見ていく方が、
最終ゴールまでの道を見失わなくて済む気がする。

### 6.2 Scale Transformations

よく分かってなかったScale transformationとcoordinate transformationの区別などが書かれている。

- smoothなどの統計操作が対象となるものの分布を仮定しているので、その分布になるようなscalingなどは統計操作の前に行われないといけない。
- coordのtransformationは見た目の変更であり、geometricな変更をしたいのであってstatisticalな意味を変えたい訳では無いので、stats操作のあとに行われる必要がある。

なるほど、理解した気がする。なんでscaleのあとにstats操作があるのか、と疑問に思っていたが、
例えばlogにすると線形の関係がある、という場合は、logにしたあとにstatsの操作が行われる必要がある。
こういう事をする為にscaleのあとにstatsの操作になっているのだな。

もちろん、logにしたあとにされては困る統計操作もありえるが、そういう場合に適切な統計操作になるように設計するのは、
グラフを作る人の責任な訳だな。そりゃそうか。

scaleをlogにするとtickはそれに応じて10, 100, 1000と振られるが、
coordの方にlogをすると、tickはscaleに応じて5, 10, 15と振られて、それが端に依る感じになる、との事。なるほど。
なお、scaleの手前の変数にlogを適用すると、log(income)のようなラベルになり、tickは普通に5, 10, 15となるる、とも書かれて いる。これもなるほど。

### 6.2.1から具体的なcatなどの話が始まる

6.2.1から先だけ読む方がこの章はわかりやすいんじゃないか、という気がする。
6.1は既存の研究との関連などの歴史的経緯だよなぁ。
結論だけに興味があるのなら、6.2.1以降を見てから6.1を解釈する方が良い気がする。

### 6章を読み終わっての読み方の結論

6章を読み終わって、この本は読み方を気をつけないと挫折しがちと感じた。
まず章の最初がどうでもいい話（ギリシャ語ではXXが起源で〜とか）とか、
抽象的な話が続くが、これらはのちに来る具体例を見る方が分かりやすい事が多い。
だから序盤であまり時間を使いすぎるのは良くない。

一方で具体例が出てきた時にどこに気をつけて見るべきか、
という事を知る為に、序盤を見ておく事自体は必要。
序盤は分からない所を頑張って理解するのではなく、分からない所をはっきりさせる為に読む感じで進むのが良い。

後の具体例は逆に細かすぎる話が続く事が多いが、その項目自体がGoG的な理解からはあまり重要では無い、
実装が面倒だが使う分には細かい事を気にする必要が無い項目などは、積極的に飛ばす方が良い。
また、概念的に並列に並べられる物の説明が続く事が多いが、一つを理解すれば、
あとはこれと同じ概念が続くのね、と読み飛ばしても問題無い事が多い。
むしろ個々の項目の詳細を読んでいくとなんの話をしているかわからなくなっていくので、
積極的に飛ばす方が良い。

そういう感じでさらさら読んでいく方が理解も深まるし速く楽に読めるので、そう読むべき本だと思う。

## 7章 statistics

`point(position(summary.mean(gov*birth)))` とあった時の、positionの意味がよくわからなくなってきたな。
これはあとで出てくるのかな？
たぶんどれがcolorを表していてどれがpositionを表すのか、とかを区別する為かな？
とするならこれはaes？aesの章まで行けばわかるだろうから先に進もう。

追記： 7.2からの例を見ていたら自分の推測は正しい気がしてきた。

7.2の後半は飛ばす。statisticsが何なのか分かれば十分だろう、という事で。だいたい理解出来たと思うので次に行こう。

## 8章 Geometry

