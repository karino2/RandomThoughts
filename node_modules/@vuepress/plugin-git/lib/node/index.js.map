{"version":3,"file":"index.js","sources":["../../src/node/locales.ts","../../src/node/prepareClientConfigFile.ts","../../src/node/utils/checkGithubUsername.ts","../../src/node/utils/checkGitRepo.ts","../../src/node/utils/digestSHA256.ts","../../src/node/utils/logger.ts","../../src/node/utils/getCommits.ts","../../src/node/utils/getContributorInfo.ts","../../src/node/utils/getUserNameWithNoreplyEmail.ts","../../src/node/utils/inferGitProvider.ts","../../src/node/utils/injectGitOptions.ts","../../src/node/utils/sanitizeHTML.ts","../../src/node/resolveChangelog.ts","../../src/node/resolveContributors.ts","../../src/node/gitPlugin.ts"],"sourcesContent":["import type { DefaultLocaleInfo } from '@vuepress/helper'\nimport type { GitLocaleData } from '../shared/index.js'\n\nexport const gitLocaleInfo: DefaultLocaleInfo<GitLocaleData> = [\n  [\n    ['en', 'en-US'],\n    {\n      contributors: 'Contributors',\n      changelog: 'Changelog',\n      timeOn: 'on',\n      viewChangelog: 'View All Changelog',\n      latestUpdateAt: 'Last Updated',\n    },\n  ],\n  [\n    ['zh', 'zh-CN', 'zh-Hans'],\n    {\n      contributors: '贡献者',\n      changelog: '更新日志',\n      timeOn: '于',\n      viewChangelog: '查看所有更新日志',\n      latestUpdateAt: '最近更新',\n    },\n  ],\n  [\n    ['zh-TW', 'zh-Hant'],\n    {\n      contributors: '貢獻者',\n      changelog: '更新日誌',\n      timeOn: '於',\n      viewChangelog: '查看所有更新日誌',\n      latestUpdateAt: '最近更新',\n    },\n  ],\n  [\n    ['de', 'de-DE'],\n    {\n      contributors: 'Mitwirkende',\n      changelog: 'Aenderungen',\n      timeOn: 'am',\n      viewChangelog: 'Alle Aenderungen anzeigen',\n      latestUpdateAt: 'Zuletzt aktualisiert',\n    },\n  ],\n  [\n    ['de-AT'],\n    {\n      contributors: 'Mitwirkende',\n      changelog: 'Aenderungen',\n      timeOn: 'am',\n      viewChangelog: 'Alle Aenderungen anzeigen',\n      latestUpdateAt: 'Zuletzt aktualisiert',\n    },\n  ],\n  [\n    ['vi', 'vi-VN'],\n    {\n      contributors: 'Người tham gia',\n      changelog: 'Lịch sử thay đổi',\n      timeOn: 'vào',\n      viewChangelog: 'Xem tất cả lịch sử thay đổi',\n      latestUpdateAt: 'Cập nhật gần nhất',\n    },\n  ],\n  [\n    ['uk'],\n    {\n      contributors: 'Учасники',\n      changelog: 'Історія змін',\n      timeOn: 'в',\n      viewChangelog: 'Показати всю історію змін',\n      latestUpdateAt: 'Останнє оновлення',\n    },\n  ],\n  [\n    ['ru', 'ru-RU'],\n    {\n      contributors: 'Участники',\n      changelog: 'История изменений',\n      timeOn: 'в',\n      viewChangelog: 'Показать всю историю изменений',\n      latestUpdateAt: 'Последнее обновление',\n    },\n  ],\n  [\n    ['br'],\n    {\n      contributors: 'Colaboradores',\n      changelog: 'Log de Alterações',\n      timeOn: 'em',\n      viewChangelog: 'Ver todas as Alterações',\n      latestUpdateAt: 'Atualizado em',\n    },\n  ],\n  [\n    ['pl', 'pl-PL'],\n    {\n      contributors: 'Współpracownicy',\n      changelog: 'Zmiany',\n      timeOn: 'w',\n      viewChangelog: 'Zobacz wszystkie zmiany',\n      latestUpdateAt: 'Ostatnio zaktualizowano',\n    },\n  ],\n  [\n    ['sk', 'sk-SK'],\n    {\n      contributors: 'Pracovnici',\n      changelog: 'Zmeny',\n      timeOn: 'na',\n      viewChangelog: 'Zobrazit vsetky zmeny',\n      latestUpdateAt: 'Poslednou aktualizaciu',\n    },\n  ],\n  [\n    ['fr', 'fr-FR'],\n    {\n      contributors: 'Contribueurs',\n      changelog: 'Historique des modifications',\n      timeOn: 'le',\n      viewChangelog: \"Voir l'historique des modifications\",\n      latestUpdateAt: 'Dernière mise à jour',\n    },\n  ],\n  [\n    ['es', 'es-ES'],\n    {\n      contributors: 'Colaboradores',\n      changelog: 'Historial de cambios',\n      timeOn: 'el',\n      viewChangelog: 'Ver el historial de cambios',\n      latestUpdateAt: 'Actualizado el',\n    },\n  ],\n  [\n    ['ja', 'ja-JP'],\n    {\n      contributors: '貢献者',\n      changelog: '変更履歴',\n      timeOn: '日',\n      viewChangelog: '全ての変更履歴を表示',\n      latestUpdateAt: '最終更新',\n    },\n  ],\n  [\n    ['tr', 'tr-TR'],\n    {\n      contributors: 'Katkıda bulunanlar',\n      changelog: 'Düzenleme Girişimleri',\n      timeOn: 'de',\n      viewChangelog: 'Tüm düzenleme girişimlerini göster',\n      latestUpdateAt: 'Son günceleme',\n    },\n  ],\n  [\n    ['ko', 'ko-KO'],\n    {\n      contributors: '기업자',\n      changelog: '변경 기록',\n      timeOn: '에서',\n      viewChangelog: '변경 기록 별 상세 내용 바보기',\n      latestUpdateAt: '최근 수정',\n    },\n  ],\n  [\n    ['fi', 'fi-FI'],\n    {\n      contributors: 'Osallistujat',\n      changelog: 'Muutokset',\n      timeOn: 'kun',\n      viewChangelog: 'Näytä kaikki muutokset',\n      latestUpdateAt: 'Viimeksi paivittynyt',\n    },\n  ],\n  [\n    ['hu', 'hu-HU'],\n    {\n      contributors: 'Szerkesztők',\n      changelog: 'Modosítások',\n      timeOn: 'ben',\n      viewChangelog: 'Minden modosítás megtekintése',\n      latestUpdateAt: 'Legutóbb frissítés',\n    },\n  ],\n  [\n    ['id', 'id-ID'],\n    {\n      contributors: 'Pembuat',\n      changelog: 'Perubahan',\n      timeOn: 'pada',\n      viewChangelog: 'Lihat semua perubahan',\n      latestUpdateAt: 'Diperbarui terakhir',\n    },\n  ],\n  [\n    ['nl', 'nl-NL'],\n    {\n      contributors: 'Bijdragers',\n      changelog: 'Wijzigingen',\n      timeOn: 'op',\n      viewChangelog: 'Bekijk alle wijzigingen',\n      latestUpdateAt: 'Laatst bijgewerkt',\n    },\n  ],\n]\n","import type { App } from 'vuepress'\nimport { ensureEndingSlash } from 'vuepress/shared'\nimport { getDirname, path } from 'vuepress/utils'\nimport type { GitPluginOptions } from './options.js'\n\nconst { url } = import.meta\n\nconst __dirname = getDirname(url)\n\nconst CLIENT_FOLDER = ensureEndingSlash(path.resolve(__dirname, '../client'))\n\nexport const prepareClientConfigFile = (\n  app: App,\n  { changelog, contributors }: GitPluginOptions,\n): Promise<string> => {\n  const imports = new Set<string>()\n  const enhances = new Set<string>()\n\n  if (contributors ?? true) {\n    imports.add(\n      `import { GitContributors } from \"${CLIENT_FOLDER}components/GitContributors.js\";`,\n    )\n    enhances.add(`app.component(\"GitContributors\", GitContributors);`)\n  }\n\n  if (changelog) {\n    imports.add(\n      `import { GitChangelog } from \"${CLIENT_FOLDER}components/GitChangelog.js\";`,\n    )\n    enhances.add(`app.component(\"GitChangelog\", GitChangelog);`)\n  }\n\n  return app.writeTemp(\n    'git/config.js',\n    `\\\n${Array.from(imports.values()).join('\\n')}\n\nexport default {\n  enhance: ({ app }) => {\n${Array.from(enhances.values())\n  .map((line) => `    ${line}`)\n  .join('\\n')}\n  },\n};\n`,\n  )\n}\n","/**\n * Check if the username is a valid github username\n *\n * - length <= 39\n * - starts with a letter\n * - contains only letters, numbers, and hyphens\n * - does not start or end with a hyphen\n * - does not contain consecutive hyphens\n */\nexport const checkGithubUsername = (username: string): boolean => {\n  if (username.length > 39) return false\n  if (username.startsWith('-') || username.endsWith('-')) return false\n\n  return /^[a-z\\d](?:[a-z\\d]|-(?=[a-z\\d]))*$/i.test(username)\n}\n","import { execSync } from 'node:child_process'\n\n/**\n * Check if the directory is likely a valid Git repository root or subdirectory\n *\n * 检查目录是否为有效的 Git 仓库根目录或子目录\n *\n * @param cwd The directory to check.\n *\n * 要检查的目录\n */\nexport const isGitRepo = (cwd: string): boolean => {\n  try {\n    execSync('git status', {\n      cwd,\n      stdio: 'ignore',\n      timeout: 5000, // prevent hanging\n    })\n    return true\n  } catch {\n    return false\n  }\n}\n","import { createHash } from 'node:crypto'\n\nexport const digestSHA256 = (message: string): string => {\n  const hash = createHash('sha256')\n  hash.update(message)\n\n  return hash.digest('hex')\n}\n","import { Logger } from '@vuepress/helper'\n\nexport const PLUGIN_NAME = '@vuepress/plugin-git'\nexport const logger = new Logger(PLUGIN_NAME)\n","import { spawn } from 'node:child_process'\nimport type { GitContributorInfo } from '../../shared/index.js'\nimport type { GitPluginOptions } from '../options.js'\nimport type { MergedRawCommit, RawCommit } from '../typings.js'\nimport { logger } from './logger.js'\n\nconst INFO_SPLITTER = '[|]'\nconst COMMIT_SPLITTER = '\\\\|/'\nconst RE_CO_AUTHOR = /^ *Co-authored-by: ?([^<]*)<([^>]*)> */gim\n\nconst getCoAuthorsFromCommitBody = (\n  body: string,\n): Pick<GitContributorInfo, 'email' | 'name'>[] =>\n  body\n    ? Array.from(body.matchAll(RE_CO_AUTHOR)).map(([, name, email]) => ({\n        name: name.trim(),\n        email: email.trim(),\n      }))\n    : []\n\nconst getGitLogFormat = ({\n  contributors,\n  changelog,\n}: GitPluginOptions): string => {\n  if (!contributors && !changelog)\n    // hash | author_date\n    return ['%H', '%ad'].join(INFO_SPLITTER)\n\n  if (contributors && !changelog)\n    // hash | author_date | author_name | author_email | body\n    return ['%H', '%ad', '%an', '%ae', '%b'].join(INFO_SPLITTER)\n\n  // hash | author_date | author_name | author_email | body | subject | ref\n  return ['%H', '%ad', '%an', '%ae', '%b', '%s', '%d'].join(INFO_SPLITTER)\n}\n\n/**\n * Helper function to run git command using spawn and return stdout as a promise.\n * Rejects if the git command exits with a non-zero code.\n */\nconst runGitLog = (args: string[], cwd: string): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const gitProcess = spawn('git', ['log', ...args], {\n      cwd,\n      stdio: ['ignore', 'pipe', 'pipe'],\n    })\n\n    let stdoutData = ''\n    let stderrData = ''\n\n    gitProcess.stdout.on('data', (chunk: Buffer) => {\n      stdoutData += chunk.toString('utf8')\n    })\n\n    gitProcess.stderr.on('data', (chunk: Buffer) => {\n      stderrData += chunk.toString('utf8')\n    })\n\n    gitProcess.on('error', (error) => {\n      reject(new Error(`Failed to spawn 'git log': ${error.message}`))\n    })\n\n    gitProcess.on('close', (code) => {\n      if (code === 0) {\n        resolve(stdoutData)\n      } else {\n        reject(\n          new Error(\n            `'git log' failed with exit code ${code}: ${stderrData.trim()}`,\n          ),\n        )\n      }\n    })\n  })\n\n/**\n * Get raw commits for a specific file\n *\n * ${commit_hash} ${author_name} ${author_email} ${author_date} ${subject} ${ref} ${body}\n *\n * @see {@link https://git-scm.com/docs/pretty-formats | documentation} for details.\n */\nexport const getRawCommits = async (\n  filepath: string,\n  cwd: string,\n  options: GitPluginOptions,\n): Promise<RawCommit[]> => {\n  const format = getGitLogFormat(options)\n\n  try {\n    const stdout = await runGitLog(\n      [\n        '--max-count=-1',\n        `--format=${format}${COMMIT_SPLITTER}`,\n        '--date=unix',\n        '--follow',\n        '--',\n        filepath,\n      ],\n      cwd,\n    )\n\n    return stdout\n      .slice(0, -1 - COMMIT_SPLITTER.length)\n      .split(`${COMMIT_SPLITTER}\\n`)\n      .filter(Boolean)\n      .map((rawString) => {\n        const [\n          hash,\n          time,\n          author = '',\n          email = '',\n          body = '',\n          message = '',\n          refs = '',\n        ] = rawString.split(INFO_SPLITTER).map((v) => v.trim())\n\n        return {\n          filepath,\n          hash,\n          time: Number.parseInt(time, 10) * 1000,\n          message,\n          body,\n          refs,\n          author,\n          email,\n          coAuthors: getCoAuthorsFromCommitBody(body),\n        }\n      })\n  } catch (error) {\n    logger.error(`Failed to get commits for ${filepath} in ${cwd}:`, error)\n\n    return []\n  }\n}\n\n/**\n * Merge raw commits by hash\n *\n * 按哈希值合并原始提交记录\n *\n * @param commits - Raw commits\n *\n * 原始提交记录\n */\nexport const mergeRawCommits = (commits: RawCommit[]): MergedRawCommit[] => {\n  const commitMap = new Map<string, MergedRawCommit>()\n\n  commits.forEach(({ filepath, ...commit }) => {\n    const _commit = commitMap.get(commit.hash)\n\n    if (_commit) _commit.filepaths.push(filepath)\n    else commitMap.set(commit.hash, { ...commit, filepaths: [filepath] })\n  })\n\n  const result = Array.from(commitMap.values())\n  return result\n}\n\n/**\n * Get merged commits for multiple file paths\n *\n * 获取多个文件路径的合并提交记录\n *\n * @param filepaths - File paths to get commits for\n *\n * 要获取提交记录的文件路径\n *\n * @param cwd - Working directory\n *\n * 工作目录\n *\n * @param options - Git plugin options\n *\n * Git 插件选项\n */\nexport const getCommits = async (\n  filepaths: string[],\n  cwd: string,\n  options: GitPluginOptions,\n): Promise<MergedRawCommit[]> => {\n  const rawCommits = (\n    await Promise.all(\n      filepaths.map((filepath) => getRawCommits(filepath, cwd, options)),\n    )\n  ).flat()\n\n  return mergeRawCommits(rawCommits).sort((a, b) => b.time - a.time)\n}\n","import type { ContributorInfo } from '../options.js'\n\nconst toArray = <T = unknown>(value?: T | T[]): T[] =>\n  Array.isArray(value) ? value : value ? [value] : []\n\nexport const getContributorInfo = (\n  contributor: { name: string; email?: string },\n  infos: ContributorInfo[] = [],\n): ContributorInfo | null =>\n  infos.find(\n    ({ username, alias, email, emailAlias }) =>\n      username === contributor.name ||\n      toArray(alias).includes(contributor.name) ||\n      (contributor.email &&\n        (contributor.email === email ||\n          toArray(emailAlias).includes(contributor.email))),\n  ) ?? null\n","export const getUserNameWithNoreplyEmail = (email: string): string | null =>\n  email.endsWith('@users.noreply.github.com')\n    ? email.replace('@users.noreply.github.com', '').split('+')[1]\n    : null\n","import type { ExecSyncOptionsWithStringEncoding } from 'node:child_process' // Import native execSync\nimport { execSync } from 'node:child_process'\nimport type { KnownGitProvider } from '../../shared/index.js'\n\n/**\n * Gets the URL of a Git remote.\n *\n * 获取 Git 远程仓库的 URL\n *\n * @param cwd - The directory where the git commands should be executed.\n *\n * 执行 git 命令的目录\n */\nexport const getRemoteUrl = (cwd: string): string | null => {\n  const execOptions: ExecSyncOptionsWithStringEncoding = {\n    cwd,\n    encoding: 'utf8',\n    stdio: ['pipe', 'pipe', 'ignore'],\n    // prevent hanging\n    timeout: 5000,\n  }\n\n  try {\n    const originUrl = execSync('git remote get-url origin', execOptions)\n\n    return originUrl.trim()\n  } catch {\n    try {\n      const remotesOutput = execSync('git remote', execOptions)\n      const firstRemote = remotesOutput.split('\\n')[0]?.trim()\n\n      if (firstRemote) {\n        const remoteUrl = execSync(\n          `git remote get-url ${firstRemote}`,\n          execOptions,\n        )\n\n        return remoteUrl.trim()\n      }\n\n      return null\n    } catch {\n      return null\n    }\n  }\n}\n\n/**\n * Infer git provider from remote URL\n *\n * 从远程 URL 推断 Git 提供商\n *\n * @param cwd - The directory where the git commands should be executed\n *\n * 执行 git 命令的目录\n */\nexport const inferGitProvider = (cwd: string): KnownGitProvider | null => {\n  const remoteUrl = getRemoteUrl(cwd)\n\n  if (!remoteUrl) return null\n\n  if (remoteUrl.includes('github.com')) {\n    return 'github'\n  }\n\n  if (remoteUrl.includes('gitlab.com')) {\n    return 'gitlab'\n  }\n\n  if (remoteUrl.includes('gitee.com')) {\n    return 'gitee'\n  }\n\n  if (remoteUrl.includes('bitbucket.org')) {\n    return 'bitbucket'\n  }\n\n  return null\n}\n","import { isPlainObject } from 'vuepress/shared'\nimport type {\n  GitInjectOptions,\n  GitUrlPattern,\n  KnownGitProvider,\n} from '../../shared/index.js'\nimport type { ChangelogOptions } from '../options.js'\n\nconst PATTERN_PRESET: Record<KnownGitProvider, GitUrlPattern> = {\n  github: {\n    issue: ':repo/issues/:issue',\n    tag: ':repo/releases/tag/:tag',\n    commit: ':repo/commit/:hash',\n  },\n  gitlab: {\n    issue: ':repo/-/issues/:issue',\n    tag: ':repo/-/releases/:tag',\n    commit: ':repo/-/commit/:hash',\n  },\n  gitee: {\n    issue: ':repo/issues/:issue',\n    tag: ':repo/releases/tag/:tag',\n    commit: ':repo/commit/:hash',\n  },\n  bitbucket: {\n    issue: ':repo/issues/:issue',\n    tag: ':repo/src/:hash',\n    commit: ':repo/commits/:hash',\n  },\n}\n\nconst getPattern = (\n  { commitUrlPattern, issueUrlPattern, tagUrlPattern }: ChangelogOptions,\n  provider: KnownGitProvider | null,\n): GitUrlPattern => {\n  const fallback = provider ? PATTERN_PRESET[provider] : {}\n\n  return {\n    commit: commitUrlPattern ?? fallback.commit,\n    issue: issueUrlPattern ?? fallback.issue,\n    tag: tagUrlPattern ?? fallback.tag,\n  }\n}\n\nexport const injectGitOptions = (\n  provider: KnownGitProvider | null,\n  changelog: ChangelogOptions | boolean,\n): GitInjectOptions => {\n  const data: GitInjectOptions = {\n    provider,\n  }\n  if (changelog) {\n    const changelogOptions = isPlainObject(changelog) ? changelog : {}\n    data.pattern = getPattern(changelogOptions, provider)\n    data.repo = changelogOptions.repoUrl\n  }\n\n  return data\n}\n","import rehypeParse from 'rehype-parse'\nimport rehypeSanitize from 'rehype-sanitize'\nimport rehypeStringify from 'rehype-stringify'\nimport type { Processor } from 'unified'\nimport { unified } from 'unified'\n\nlet rehypeInstance: Processor | null = null\n\n/**\n * Sanitize HTML\n * @see https://github.com/rehypejs/rehype-sanitize\n */\nexport const sanitizeHTML = (html: string): string => {\n  rehypeInstance ??= unified()\n    .use(rehypeParse, { fragment: true })\n    .use(rehypeSanitize, {\n      tagNames: ['a', 'em', 'strong', 'code'],\n      attributes: {\n        a: [['href', /^https?:\\/\\//], 'target', 'rel'],\n      },\n      strip: ['script', 'style'],\n    })\n    .use(rehypeStringify)\n    .freeze() as unknown as Processor\n\n  return String(rehypeInstance.processSync(html))\n}\n","import type { App } from 'vuepress'\nimport type { GitChangelogInfo } from '../shared/index.js'\nimport type { ChangelogOptions, ContributorInfo } from './options.js'\nimport type { MergedRawCommit } from './typings.js'\nimport {\n  getContributorInfo,\n  getUserNameWithNoreplyEmail,\n  sanitizeHTML,\n} from './utils/index.js'\n\nconst RE_CLEAN_REFS = /[()]/g\n\nconst parseTagName = (refs: string): string | undefined => {\n  if (!refs) return\n\n  const tags = refs\n    .replace(RE_CLEAN_REFS, '')\n    .split(',')\n    .map((tag) => tag.trim())\n\n  return tags[0]?.includes('tag:') ? tags[0].replace('tag:', '').trim() : ''\n}\n\n/**\n * Resolve changelog\n *\n * 解析变更日志\n *\n * @param app - VuePress app instance\n *\n * VuePress 应用实例\n *\n * @param commits - Git commits\n *\n * Git 提交记录\n *\n * @param options - Changelog options\n *\n * 变更日志选项\n *\n * @param contributors - Contributor info\n *\n * 贡献者信息\n */\nexport const resolveChangelog = (\n  app: App,\n  commits: MergedRawCommit[],\n  options: ChangelogOptions,\n  contributors: ContributorInfo[],\n): GitChangelogInfo[] => {\n  const result: GitChangelogInfo[] = []\n\n  const sliceCommits = options.maxCount\n    ? commits.slice(0, options.maxCount)\n    : commits\n\n  for (const commit of sliceCommits) {\n    const { hash, message, time, author, email, refs, coAuthors } = commit\n    const tag = parseTagName(refs)\n    const contributor = getContributorInfo(\n      { name: getUserNameWithNoreplyEmail(email) ?? author, email },\n      contributors,\n    )\n    const resolved: GitChangelogInfo = {\n      hash,\n      time,\n      email: contributor?.email || email,\n      author: contributor?.name ?? contributor?.username ?? author,\n      message: sanitizeHTML(app.markdown.renderInline(message)),\n    }\n\n    if (coAuthors.length) resolved.coAuthors = coAuthors\n\n    if (tag) resolved.tag = tag\n\n    result.push(resolved)\n  }\n\n  return result\n}\n","import type { GitContributorInfo, KnownGitProvider } from '../shared/index.js'\nimport type { ContributorsOptions } from './options.js'\nimport type { MergedRawCommit } from './typings.js'\nimport {\n  checkGithubUsername,\n  digestSHA256,\n  getContributorInfo,\n  getUserNameWithNoreplyEmail,\n} from './utils/index.js'\n\n/**\n * Get raw contributors from commits\n *\n * 从提交记录中获取原始贡献者信息\n *\n * @param commits - Git commits\n *\n * Git 提交记录\n *\n * @param options - Contributors options\n *\n * 贡献者选项\n *\n * @param gitProvider - Git provider\n *\n * Git 提供商\n */\nexport const getRawContributors = (\n  commits: MergedRawCommit[],\n  options: ContributorsOptions,\n  gitProvider: KnownGitProvider | null,\n): GitContributorInfo[] => {\n  const contributors = new Map<string, GitContributorInfo>()\n\n  // copy and reverse commits\n  for (const commit of [...commits].reverse()) {\n    const authors = [\n      { name: commit.author, email: commit.email },\n      ...commit.coAuthors,\n    ]\n\n    for (const { name, email } of authors) {\n      const usernameWithNoreplyEmail = getUserNameWithNoreplyEmail(email)\n      const config = getContributorInfo(\n        { name: usernameWithNoreplyEmail ?? name, email },\n        options.info,\n      )\n\n      // Only trust the username from `info` and `noreply email`.\n      const username = config?.username ?? usernameWithNoreplyEmail\n\n      const contributor = contributors.get(username ?? name)\n\n      if (contributor) {\n        contributor.commits++\n        // try to rewrite the no-reply email to a genuine email\n        if (contributor.email.includes('@users.noreply.github.com')) {\n          contributor.email = config?.email ?? email\n        }\n      } else {\n        const item: GitContributorInfo = {\n          name: config?.name ?? username ?? name,\n          // if `username` not found, check if `name` is a valid github username\n          username:\n            username ??\n            (gitProvider === 'github' && checkGithubUsername(name) ? name : ''),\n          email: config?.email || email,\n          commits: 1,\n        }\n\n        if (options.avatar)\n          item.avatar =\n            config?.avatar ??\n            (item.username\n              ? options.avatarPattern?.replace(':username', item.username)\n              : null) ??\n            (item.username\n              ? `https://avatars.githubusercontent.com/${item.username}?v=4`\n              : `https://gravatar.com/avatar/${digestSHA256(email)}?d=retro`)\n\n        const url =\n          config?.url ??\n          (item.username ? `https://github.com/${item.username}` : undefined)\n\n        if (url) item.url = url\n\n        contributors.set(username ?? name, item)\n      }\n    }\n  }\n\n  return Array.from(contributors.values()).filter((item, index, self) => {\n    // If one of the contributors is a \"noreply\" email address, and there's\n    // already a contributor with the same name, it is very likely a duplicate,\n    // so it can be removed.\n    if (item.email.split('@')[1]?.match(/no-?reply/)) {\n      const realIndex = self.findIndex((t) => t.name === item.name)\n      if (realIndex !== index) {\n        // Update the \"real\" contributor to also include the noreply's commits\n        self[realIndex].commits += item.commits\n        return false\n      }\n      return true\n    }\n    return true\n  })\n}\n\n/**\n * Resolve contributors\n *\n * 解析贡献者\n *\n * @param commits - Git commits\n *\n * Git 提交记录\n *\n * @param gitProvider - Git provider\n *\n * Git 提供商\n *\n * @param options - Contributors options\n *\n * 贡献者选项\n *\n * @param extraContributors - Extra contributors\n *\n * 额外贡献者\n *\n * @default []\n */\nexport const resolveContributors = (\n  commits: MergedRawCommit[],\n  gitProvider: KnownGitProvider | null,\n  options: ContributorsOptions,\n  extraContributors: string[] = [],\n): GitContributorInfo[] => {\n  const contributors = getRawContributors(commits, options, gitProvider)\n\n  if (options.info?.length && extraContributors.length) {\n    for (const extraContributor of extraContributors) {\n      if (\n        contributors.every(\n          (item) =>\n            item.username !== extraContributor &&\n            item.name !== extraContributor,\n        )\n      ) {\n        const contributorInfo = getContributorInfo(\n          { name: extraContributor },\n          options.info,\n        )\n\n        if (!contributorInfo) continue\n\n        const result: GitContributorInfo = {\n          name: contributorInfo.name ?? extraContributor,\n          username: contributorInfo.username,\n          email: contributorInfo.email ?? '',\n          commits: 0,\n        }\n\n        const url =\n          contributorInfo.url ??\n          (gitProvider === 'github'\n            ? `https://github.com/${contributorInfo.username}`\n            : null)\n\n        if (options.avatar)\n          result.avatar =\n            contributorInfo.avatar ??\n            options.avatarPattern?.replace(\n              ':username',\n              contributorInfo.username,\n            ) ??\n            (gitProvider === 'github'\n              ? `https://avatars.githubusercontent.com/${contributorInfo.username}?v=4`\n              : `https://gravatar.com/avatar/${digestSHA256(contributorInfo.username)}?d=retro`)\n\n        if (url) result.url = url\n\n        contributors.push(result)\n      }\n    }\n  }\n\n  return options.transform?.(contributors) ?? contributors\n}\n","import { getFullLocaleConfig } from '@vuepress/helper'\nimport type { Page, Plugin } from 'vuepress/core'\nimport { isPlainObject } from 'vuepress/shared'\nimport { path } from 'vuepress/utils'\nimport type {\n  GitPluginFrontmatter,\n  GitPluginPageData,\n} from '../shared/index.js'\nimport { gitLocaleInfo } from './locales.js'\nimport type { GitPluginOptions } from './options.js'\nimport { prepareClientConfigFile } from './prepareClientConfigFile.js'\nimport { resolveChangelog } from './resolveChangelog.js'\nimport { resolveContributors } from './resolveContributors.js'\nimport {\n  PLUGIN_NAME,\n  getCommits,\n  inferGitProvider,\n  injectGitOptions,\n  isGitRepo,\n} from './utils/index.js'\n\n/**\n * Git plugin\n *\n * Git 插件\n *\n * @param [options={}] - Plugin options / 插件选项\n *\n * @example\n * ```ts\n * import { gitPlugin } from '@vuepress/plugin-git'\n *\n * export default {\n *   plugins: [\n *     gitPlugin({\n *       createdTime: true,\n *       updatedTime: true,\n *       contributors: true,\n *       changelog: false\n *     })\n *   ]\n * }\n * ```\n */\nexport const gitPlugin =\n  ({\n    createdTime = true,\n    updatedTime = true,\n    contributors = true,\n    changelog = false,\n    filter,\n    // eslint-disable-next-line @typescript-eslint/no-deprecated\n    transformContributors,\n    locales = {},\n  }: GitPluginOptions = {}): Plugin =>\n  (app) => {\n    const cwd = app.dir.source()\n    const isGitRepoValid = isGitRepo(cwd)\n    const gitProvider = isGitRepoValid ? inferGitProvider(cwd) : null\n    return {\n      name: PLUGIN_NAME,\n\n      define: {\n        __GIT_CHANGELOG__: Boolean(changelog),\n        __GIT_CONTRIBUTORS__: Boolean(contributors),\n        __GIT_LOCALES__: getFullLocaleConfig({\n          app,\n          name: PLUGIN_NAME,\n          default: gitLocaleInfo,\n          config: locales,\n        }),\n        __GIT_OPTIONS__: injectGitOptions(gitProvider, changelog),\n      },\n\n      extendsPage: async (\n        page: Page<GitPluginPageData, GitPluginFrontmatter>,\n      ) => {\n        page.data.git = {}\n\n        if (!isGitRepoValid || page.filePathRelative === null) {\n          return\n        }\n\n        if (filter && !filter(page)) return\n\n        const { frontmatter } = page\n\n        // skip if all features are disabled\n        if (\n          !(frontmatter.contributors ?? contributors) &&\n          !(frontmatter.changelog ?? changelog) &&\n          !createdTime &&\n          !updatedTime\n        ) {\n          return\n        }\n\n        const filePaths = [\n          page.filePathRelative,\n          ...(page.frontmatter.gitInclude ?? []).map((item) =>\n            path.join(page.filePathRelative, '..', item),\n          ),\n        ]\n\n        const commits = await getCommits(filePaths, cwd, {\n          contributors: (frontmatter.contributors ?? contributors) !== false,\n          changelog: frontmatter.changelog ?? changelog,\n        })\n\n        if (commits.length === 0) return\n\n        if (createdTime) {\n          page.data.git.createdTime = commits[commits.length - 1].time\n        }\n\n        if (updatedTime) {\n          page.data.git.updatedTime = commits[0].time\n        }\n\n        const contributorsOptions = isPlainObject(contributors)\n          ? contributors\n          : {}\n\n        if (frontmatter.contributors ?? contributors) {\n          contributorsOptions.transform ??= transformContributors\n          page.data.git.contributors = resolveContributors(\n            commits,\n            gitProvider,\n            contributorsOptions,\n            Array.isArray(frontmatter.contributors)\n              ? frontmatter.contributors\n              : [],\n          )\n        }\n\n        if (frontmatter.changelog ?? changelog) {\n          const changelogOptions = isPlainObject(changelog) ? changelog : {}\n\n          page.data.git.changelog = resolveChangelog(\n            app,\n            commits,\n            changelogOptions,\n            contributorsOptions.info ?? [],\n          )\n        }\n      },\n\n      // remove `gitInclude` from frontmatter\n      onInitialized: () => {\n        app.pages.forEach((page) => {\n          delete page.frontmatter.gitInclude\n        })\n      },\n\n      clientConfigFile: () =>\n        prepareClientConfigFile(app, { changelog, contributors }),\n    }\n  }\n"],"names":["gitLocaleInfo","url","__dirname","getDirname","CLIENT_FOLDER","ensureEndingSlash","path","prepareClientConfigFile","app","changelog","contributors","imports","enhances","line","checkGithubUsername","username","isGitRepo","cwd","execSync","digestSHA256","message","hash","createHash","PLUGIN_NAME","logger","Logger","INFO_SPLITTER","COMMIT_SPLITTER","RE_CO_AUTHOR","getCoAuthorsFromCommitBody","body","name","email","getGitLogFormat","runGitLog","args","resolve","reject","gitProcess","spawn","stdoutData","stderrData","chunk","error","code","getRawCommits","filepath","options","format","rawString","time","author","refs","v","mergeRawCommits","commits","commitMap","commit","_commit","getCommits","filepaths","rawCommits","a","b","toArray","value","getContributorInfo","contributor","infos","alias","emailAlias","getUserNameWithNoreplyEmail","getRemoteUrl","execOptions","firstRemote","inferGitProvider","remoteUrl","PATTERN_PRESET","getPattern","commitUrlPattern","issueUrlPattern","tagUrlPattern","provider","fallback","injectGitOptions","data","changelogOptions","isPlainObject","rehypeInstance","sanitizeHTML","html","unified","rehypeParse","rehypeSanitize","rehypeStringify","RE_CLEAN_REFS","parseTagName","tags","tag","resolveChangelog","result","sliceCommits","coAuthors","resolved","getRawContributors","gitProvider","authors","usernameWithNoreplyEmail","config","item","index","self","realIndex","t","resolveContributors","extraContributors","extraContributor","contributorInfo","gitPlugin","createdTime","updatedTime","filter","transformContributors","locales","isGitRepoValid","getFullLocaleConfig","page","frontmatter","filePaths","contributorsOptions"],"mappings":"+ZAGO,MAAMA,EAAkD,CAC7D,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,eACd,UAAW,YACX,OAAQ,KACR,cAAe,qBACf,eAAgB,cAClB,CACF,EACA,CACE,CAAC,KAAM,QAAS,SAAS,EACzB,CACE,aAAc,MACd,UAAW,OACX,OAAQ,IACR,cAAe,WACf,eAAgB,MAClB,CACF,EACA,CACE,CAAC,QAAS,SAAS,EACnB,CACE,aAAc,MACd,UAAW,OACX,OAAQ,IACR,cAAe,WACf,eAAgB,MAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,cACd,UAAW,cACX,OAAQ,KACR,cAAe,4BACf,eAAgB,sBAClB,CACF,EACA,CACE,CAAC,OAAO,EACR,CACE,aAAc,cACd,UAAW,cACX,OAAQ,KACR,cAAe,4BACf,eAAgB,sBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,oBACd,UAAW,wBACX,OAAQ,OACR,cAAe,sCACf,eAAgB,2BAClB,CACF,EACA,CACE,CAAC,IAAI,EACL,CACE,aAAc,WACd,UAAW,eACX,OAAQ,IACR,cAAe,4BACf,eAAgB,mBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,YACd,UAAW,oBACX,OAAQ,IACR,cAAe,iCACf,eAAgB,sBAClB,CACF,EACA,CACE,CAAC,IAAI,EACL,CACE,aAAc,gBACd,UAAW,oBACX,OAAQ,KACR,cAAe,0BACf,eAAgB,eAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,kBACd,UAAW,SACX,OAAQ,IACR,cAAe,0BACf,eAAgB,yBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,aACd,UAAW,QACX,OAAQ,KACR,cAAe,wBACf,eAAgB,wBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,eACd,UAAW,+BACX,OAAQ,KACR,cAAe,sCACf,eAAgB,sBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,gBACd,UAAW,uBACX,OAAQ,KACR,cAAe,8BACf,eAAgB,gBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,MACd,UAAW,OACX,OAAQ,IACR,cAAe,aACf,eAAgB,MAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,qBACd,UAAW,wBACX,OAAQ,KACR,cAAe,qCACf,eAAgB,eAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,MACd,UAAW,QACX,OAAQ,KACR,cAAe,oBACf,eAAgB,OAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,eACd,UAAW,YACX,OAAQ,MACR,cAAe,yBACf,eAAgB,sBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,cACd,UAAW,cACX,OAAQ,MACR,cAAe,gCACf,eAAgB,oBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,UACd,UAAW,YACX,OAAQ,OACR,cAAe,wBACf,eAAgB,qBAClB,CACF,EACA,CACE,CAAC,KAAM,OAAO,EACd,CACE,aAAc,aACd,UAAW,cACX,OAAQ,KACR,cAAe,0BACf,eAAgB,mBAClB,CACF,CACF,ECvMM,CAAE,IAAAC,CAAI,EAAI,YAEVC,GAAYC,EAAWF,CAAG,EAE1BG,EAAgBC,EAAkBC,EAAK,QAAQJ,GAAW,WAAW,CAAC,EAE/DK,GAA0B,CACrCC,EACA,CAAE,UAAAC,EAAW,aAAAC,CAAa,IACN,CACpB,MAAMC,EAAU,IAAI,IACdC,EAAW,IAAI,IAErB,OAAIF,GAAgB,MAClBC,EAAQ,IACN,oCAAoCP,CAAa,iCACnD,EACAQ,EAAS,IAAI,oDAAoD,GAG/DH,IACFE,EAAQ,IACN,iCAAiCP,CAAa,8BAChD,EACAQ,EAAS,IAAI,8CAA8C,GAGtDJ,EAAI,UACT,gBACA,GACF,MAAM,KAAKG,EAAQ,OAAA,CAAQ,EAAE,KAAK;AAAA,CAAI,CAAC;AAAA;AAAA;AAAA;AAAA,EAIvC,MAAM,KAAKC,EAAS,OAAA,CAAQ,EAC3B,IAAKC,GAAS,OAAOA,CAAI,EAAE,EAC3B,KAAK;AAAA,CAAI,CAAC;AAAA;AAAA;AAAA,CAIX,CACF,ECrCaC,EAAuBC,GAC9BA,EAAS,OAAS,IAClBA,EAAS,WAAW,GAAG,GAAKA,EAAS,SAAS,GAAG,EAAU,GAExD,sCAAsC,KAAKA,CAAQ,ECF/CC,EAAaC,GAAyB,CACjD,GAAI,CACF,OAAAC,EAAS,aAAc,CACrB,IAAAD,EACA,MAAO,SACP,QAAS,GACX,CAAC,EACM,EACT,MAAQ,CACN,QACF,CACF,ECpBaE,EAAgBC,GAA4B,CACvD,MAAMC,EAAOC,EAAW,QAAQ,EAChC,OAAAD,EAAK,OAAOD,CAAO,EAEZC,EAAK,OAAO,KAAK,CAC1B,ECLaE,EAAc,uBACdC,EAAS,IAAIC,EAAOF,CAAW,ECGtCG,EAAgB,MAChBC,EAAkB,OAClBC,GAAe,4CAEfC,GACJC,GAEAA,EACI,MAAM,KAAKA,EAAK,SAASF,EAAY,CAAC,EAAE,IAAI,CAAC,CAAA,CAAGG,EAAMC,CAAK,KAAO,CAChE,KAAMD,EAAK,OACX,MAAOC,EAAM,MACf,EAAE,EACF,CAAA,EAEAC,GAAkB,CAAC,CACvB,aAAAvB,EACA,UAAAD,CACF,IACM,CAACC,GAAgB,CAACD,EAEb,CAAC,KAAM,KAAK,EAAE,KAAKiB,CAAa,EAErChB,GAAgB,CAACD,EAEZ,CAAC,KAAM,MAAO,MAAO,MAAO,IAAI,EAAE,KAAKiB,CAAa,EAGtD,CAAC,KAAM,MAAO,MAAO,MAAO,KAAM,KAAM,IAAI,EAAE,KAAKA,CAAa,EAOnEQ,GAAY,CAACC,EAAgBlB,IACjC,IAAI,QAAQ,CAACmB,EAASC,IAAW,CAC/B,MAAMC,EAAaC,EAAM,MAAO,CAAC,MAAO,GAAGJ,CAAI,EAAG,CAChD,IAAAlB,EACA,MAAO,CAAC,SAAU,OAAQ,MAAM,CAClC,CAAC,EAED,IAAIuB,EAAa,GACbC,EAAa,GAEjBH,EAAW,OAAO,GAAG,OAASI,GAAkB,CAC9CF,GAAcE,EAAM,SAAS,MAAM,CACrC,CAAC,EAEDJ,EAAW,OAAO,GAAG,OAASI,GAAkB,CAC9CD,GAAcC,EAAM,SAAS,MAAM,CACrC,CAAC,EAEDJ,EAAW,GAAG,QAAUK,GAAU,CAChCN,EAAO,IAAI,MAAM,8BAA8BM,EAAM,OAAO,EAAE,CAAC,CACjE,CAAC,EAEDL,EAAW,GAAG,QAAUM,GAAS,CAC3BA,IAAS,EACXR,EAAQI,CAAU,EAElBH,EACE,IAAI,MACF,mCAAmCO,CAAI,KAAKH,EAAW,KAAA,CAAM,EAC/D,CACF,CAEJ,CAAC,CACH,CAAC,EASUI,EAAgB,MAC3BC,EACA7B,EACA8B,IACyB,CACzB,MAAMC,EAASf,GAAgBc,CAAO,EAEtC,GAAI,CAaF,OAZe,MAAMb,GACnB,CACE,iBACA,YAAYc,CAAM,GAAGrB,CAAe,GACpC,cACA,WACA,KACAmB,CACF,EACA7B,CACF,GAGG,MAAM,EAAG,GAAKU,EAAgB,MAAM,EACpC,MAAM,GAAGA,CAAe;AAAA,CAAI,EAC5B,OAAO,OAAO,EACd,IAAKsB,GAAc,CAClB,KAAM,CACJ5B,EACA6B,EACAC,EAAS,GACTnB,EAAQ,GACRF,EAAO,GACPV,EAAU,GACVgC,EAAO,EACT,EAAIH,EAAU,MAAMvB,CAAa,EAAE,IAAK2B,GAAMA,EAAE,KAAA,CAAM,EAEtD,MAAO,CACL,SAAAP,EACA,KAAAzB,EACA,KAAM,OAAO,SAAS6B,EAAM,EAAE,EAAI,IAClC,QAAA9B,EACA,KAAAU,EACA,KAAAsB,EACA,OAAAD,EACA,MAAAnB,EACA,UAAWH,GAA2BC,CAAI,CAC5C,CACF,CAAC,CACL,OAASa,EAAO,CACd,OAAAnB,EAAO,MAAM,6BAA6BsB,CAAQ,OAAO7B,CAAG,IAAK0B,CAAK,EAE/D,CAAA,CACT,CACF,EAWaW,EAAmBC,GAA4C,CAC1E,MAAMC,EAAY,IAAI,IAEtB,OAAAD,EAAQ,QAAQ,CAAC,CAAE,SAAAT,EAAU,GAAGW,CAAO,IAAM,CAC3C,MAAMC,EAAUF,EAAU,IAAIC,EAAO,IAAI,EAErCC,EAASA,EAAQ,UAAU,KAAKZ,CAAQ,EACvCU,EAAU,IAAIC,EAAO,KAAM,CAAE,GAAGA,EAAQ,UAAW,CAACX,CAAQ,CAAE,CAAC,CACtE,CAAC,EAEc,MAAM,KAAKU,EAAU,QAAQ,CAE9C,EAmBaG,EAAa,MACxBC,EACA3C,EACA8B,IAC+B,CAC/B,MAAMc,GACJ,MAAM,QAAQ,IACZD,EAAU,IAAKd,GAAaD,EAAcC,EAAU7B,EAAK8B,CAAO,CAAC,CACnE,GACA,KAAA,EAEF,OAAOO,EAAgBO,CAAU,EAAE,KAAK,CAACC,EAAGC,IAAMA,EAAE,KAAOD,EAAE,IAAI,CACnE,EC1LME,EAAwBC,GAC5B,MAAM,QAAQA,CAAK,EAAIA,EAAQA,EAAQ,CAACA,CAAK,EAAI,GAEtCC,EAAqB,CAChCC,EACAC,EAA2B,CAAA,IAE3BA,EAAM,KACJ,CAAC,CAAE,SAAArD,EAAU,MAAAsD,EAAO,MAAArC,EAAO,WAAAsC,CAAW,IACpCvD,IAAaoD,EAAY,MACzBH,EAAQK,CAAK,EAAE,SAASF,EAAY,IAAI,GACvCA,EAAY,QACVA,EAAY,QAAUnC,GACrBgC,EAAQM,CAAU,EAAE,SAASH,EAAY,KAAK,EACtD,GAAK,KChBMI,EAA+BvC,GAC1CA,EAAM,SAAS,2BAA2B,EACtCA,EAAM,QAAQ,4BAA6B,EAAE,EAAE,MAAM,GAAG,EAAE,CAAC,EAC3D,KCUOwC,EAAgBvD,GAA+B,CAC1D,MAAMwD,EAAiD,CACrD,IAAAxD,EACA,SAAU,OACV,MAAO,CAAC,OAAQ,OAAQ,QAAQ,EAEhC,QAAS,GACX,EAEA,GAAI,CAGF,OAFkBC,EAAS,4BAA6BuD,CAAW,EAElD,KAAA,CACnB,MAAQ,CACN,GAAI,CAEF,MAAMC,EADgBxD,EAAS,aAAcuD,CAAW,EACtB,MAAM;AAAA,CAAI,EAAE,CAAC,GAAG,OAElD,OAAIC,EACgBxD,EAChB,sBAAsBwD,CAAW,GACjCD,CACF,EAEiB,OAGZ,IACT,MAAQ,CACN,OAAO,IACT,CACF,CACF,EAWaE,EAAoB1D,GAAyC,CACxE,MAAM2D,EAAYJ,EAAavD,CAAG,EAElC,OAAK2D,EAEDA,EAAU,SAAS,YAAY,EAC1B,SAGLA,EAAU,SAAS,YAAY,EAC1B,SAGLA,EAAU,SAAS,WAAW,EACzB,QAGLA,EAAU,SAAS,eAAe,EAC7B,YAGF,KAlBgB,IAmBzB,ECtEMC,GAA0D,CAC9D,OAAQ,CACN,MAAO,sBACP,IAAK,0BACL,OAAQ,oBACV,EACA,OAAQ,CACN,MAAO,wBACP,IAAK,wBACL,OAAQ,sBACV,EACA,MAAO,CACL,MAAO,sBACP,IAAK,0BACL,OAAQ,oBACV,EACA,UAAW,CACT,MAAO,sBACP,IAAK,kBACL,OAAQ,qBACV,CACF,EAEMC,GAAa,CACjB,CAAE,iBAAAC,EAAkB,gBAAAC,EAAiB,cAAAC,CAAc,EACnDC,IACkB,CAClB,MAAMC,EAAWD,EAAWL,GAAeK,CAAQ,EAAI,CAAA,EAEvD,MAAO,CACL,OAAQH,GAAoBI,EAAS,OACrC,MAAOH,GAAmBG,EAAS,MACnC,IAAKF,GAAiBE,EAAS,GACjC,CACF,EAEaC,EAAmB,CAC9BF,EACAzE,IACqB,CACrB,MAAM4E,EAAyB,CAC7B,SAAAH,CACF,EACA,GAAIzE,EAAW,CACb,MAAM6E,EAAmBC,EAAc9E,CAAS,EAAIA,EAAY,GAChE4E,EAAK,QAAUP,GAAWQ,EAAkBJ,CAAQ,EACpDG,EAAK,KAAOC,EAAiB,OAC/B,CAEA,OAAOD,CACT,ECpDA,IAAIG,EAAmC,KAMhC,MAAMC,EAAgBC,IAC3BF,IAAmBG,EAAAA,EAChB,IAAIC,EAAa,CAAE,SAAU,EAAK,CAAC,EACnC,IAAIC,EAAgB,CACnB,SAAU,CAAC,IAAK,KAAM,SAAU,MAAM,EACtC,WAAY,CACV,EAAG,CAAC,CAAC,OAAQ,cAAc,EAAG,SAAU,KAAK,CAC/C,EACA,MAAO,CAAC,SAAU,OAAO,CAC3B,CAAC,EACA,IAAIC,CAAe,EACnB,SAEI,OAAON,EAAe,YAAYE,CAAI,CAAC,GCf1CK,GAAgB,QAEhBC,GAAgB5C,GAAqC,CACzD,GAAI,CAACA,EAAM,OAEX,MAAM6C,EAAO7C,EACV,QAAQ2C,GAAe,EAAE,EACzB,MAAM,GAAG,EACT,IAAKG,GAAQA,EAAI,KAAA,CAAM,EAE1B,OAAOD,EAAK,CAAC,GAAG,SAAS,MAAM,EAAIA,EAAK,CAAC,EAAE,QAAQ,OAAQ,EAAE,EAAE,KAAA,EAAS,EAC1E,EAuBaE,EAAmB,CAC9B3F,EACA+C,EACAR,EACArC,IACuB,CACvB,MAAM0F,EAA6B,CAAA,EAE7BC,EAAetD,EAAQ,SACzBQ,EAAQ,MAAM,EAAGR,EAAQ,QAAQ,EACjCQ,EAEJ,UAAWE,KAAU4C,EAAc,CACjC,KAAM,CAAE,KAAAhF,EAAM,QAAAD,EAAS,KAAA8B,EAAM,OAAAC,EAAQ,MAAAnB,EAAO,KAAAoB,EAAM,UAAAkD,CAAU,EAAI7C,EAC1DyC,EAAMF,GAAa5C,CAAI,EACvBe,EAAcD,EAClB,CAAE,KAAMK,EAA4BvC,CAAK,GAAKmB,EAAQ,MAAAnB,CAAM,EAC5DtB,CACF,EACM6F,EAA6B,CACjC,KAAAlF,EACA,KAAA6B,EACA,MAAOiB,GAAa,OAASnC,EAC7B,OAAQmC,GAAa,MAAQA,GAAa,UAAYhB,EACtD,QAASsC,EAAajF,EAAI,SAAS,aAAaY,CAAO,CAAC,CAC1D,EAEIkF,EAAU,SAAQC,EAAS,UAAYD,GAEvCJ,IAAKK,EAAS,IAAML,GAExBE,EAAO,KAAKG,CAAQ,CACtB,CAEA,OAAOH,CACT,ECpDaI,EAAqB,CAChCjD,EACAR,EACA0D,IACyB,CACzB,MAAM/F,EAAe,IAAI,IAGzB,UAAW+C,IAAU,CAAC,GAAGF,CAAO,EAAE,UAAW,CAC3C,MAAMmD,EAAU,CACd,CAAE,KAAMjD,EAAO,OAAQ,MAAOA,EAAO,KAAM,EAC3C,GAAGA,EAAO,SACZ,EAEA,SAAW,CAAE,KAAA1B,EAAM,MAAAC,CAAM,IAAK0E,EAAS,CACrC,MAAMC,EAA2BpC,EAA4BvC,CAAK,EAC5D4E,EAAS1C,EACb,CAAE,KAAMyC,GAA4B5E,EAAM,MAAAC,CAAM,EAChDe,EAAQ,IACV,EAGMhC,EAAW6F,GAAQ,UAAYD,EAE/BxC,EAAczD,EAAa,IAAIK,GAAYgB,CAAI,EAErD,GAAIoC,EACFA,EAAY,UAERA,EAAY,MAAM,SAAS,2BAA2B,IACxDA,EAAY,MAAQyC,GAAQ,OAAS5E,OAElC,CACL,MAAM6E,EAA2B,CAC/B,KAAMD,GAAQ,MAAQ7F,GAAYgB,EAElC,SACEhB,IACC0F,IAAgB,UAAY3F,EAAoBiB,CAAI,EAAIA,EAAO,IAClE,MAAO6E,GAAQ,OAAS5E,EACxB,QAAS,CACX,EAEIe,EAAQ,SACV8D,EAAK,OACHD,GAAQ,SACPC,EAAK,SACF9D,EAAQ,eAAe,QAAQ,YAAa8D,EAAK,QAAQ,EACzD,QACHA,EAAK,SACF,yCAAyCA,EAAK,QAAQ,OACtD,+BAA+B1F,EAAaa,CAAK,CAAC,aAE1D,MAAM/B,EACJ2G,GAAQ,MACPC,EAAK,SAAW,sBAAsBA,EAAK,QAAQ,GAAK,QAEvD5G,IAAK4G,EAAK,IAAM5G,GAEpBS,EAAa,IAAIK,GAAYgB,EAAM8E,CAAI,CACzC,CACF,CACF,CAEA,OAAO,MAAM,KAAKnG,EAAa,OAAA,CAAQ,EAAE,OAAO,CAACmG,EAAMC,EAAOC,IAAS,CAIrE,GAAIF,EAAK,MAAM,MAAM,GAAG,EAAE,CAAC,GAAG,MAAM,WAAW,EAAG,CAChD,MAAMG,EAAYD,EAAK,UAAWE,GAAMA,EAAE,OAASJ,EAAK,IAAI,EAC5D,OAAIG,IAAcF,GAEhBC,EAAKC,CAAS,EAAE,SAAWH,EAAK,QACzB,IAEF,EACT,CACA,MAAO,EACT,CAAC,CACH,EAyBaK,EAAsB,CACjC3D,EACAkD,EACA1D,EACAoE,EAA8B,CAAA,IACL,CACzB,MAAMzG,EAAe8F,EAAmBjD,EAASR,EAAS0D,CAAW,EAErE,GAAI1D,EAAQ,MAAM,QAAUoE,EAAkB,QAC5C,UAAWC,KAAoBD,EAC7B,GACEzG,EAAa,MACVmG,GACCA,EAAK,WAAaO,GAClBP,EAAK,OAASO,CAClB,EACA,CACA,MAAMC,EAAkBnD,EACtB,CAAE,KAAMkD,CAAiB,EACzBrE,EAAQ,IACV,EAEA,GAAI,CAACsE,EAAiB,SAEtB,MAAMjB,EAA6B,CACjC,KAAMiB,EAAgB,MAAQD,EAC9B,SAAUC,EAAgB,SAC1B,MAAOA,EAAgB,OAAS,GAChC,QAAS,CACX,EAEMpH,EACJoH,EAAgB,MACfZ,IAAgB,SACb,sBAAsBY,EAAgB,QAAQ,GAC9C,MAEFtE,EAAQ,SACVqD,EAAO,OACLiB,EAAgB,QAChBtE,EAAQ,eAAe,QACrB,YACAsE,EAAgB,QAClB,IACCZ,IAAgB,SACb,yCAAyCY,EAAgB,QAAQ,OACjE,+BAA+BlG,EAAakG,EAAgB,QAAQ,CAAC,aAEzEpH,IAAKmG,EAAO,IAAMnG,GAEtBS,EAAa,KAAK0F,CAAM,CAC1B,EAIJ,OAAOrD,EAAQ,YAAYrC,CAAY,GAAKA,CAC9C,EC/Ia4G,GACX,CAAC,CACC,YAAAC,EAAc,GACd,YAAAC,EAAc,GACd,aAAA9G,EAAe,GACf,UAAAD,EAAY,GACZ,OAAAgH,EAEA,sBAAAC,EACA,QAAAC,EAAU,EACZ,EAAsB,CAAA,IACrBnH,GAAQ,CACP,MAAMS,EAAMT,EAAI,IAAI,SACdoH,EAAiB5G,EAAUC,CAAG,EAC9BwF,EAAcmB,EAAiBjD,EAAiB1D,CAAG,EAAI,KAC7D,MAAO,CACL,KAAMM,EAEN,OAAQ,CACN,kBAAmB,EAAQd,EAC3B,qBAAsB,CAAA,CAAQC,EAC9B,gBAAiBmH,EAAoB,CACnC,IAAArH,EACA,KAAMe,EACN,QAASvB,EACT,OAAQ2H,CACV,CAAC,EACD,gBAAiBvC,EAAiBqB,EAAahG,CAAS,CAC1D,EAEA,YAAa,MACXqH,GACG,CAOH,GANAA,EAAK,KAAK,IAAM,CAAA,EAEZ,CAACF,GAAkBE,EAAK,mBAAqB,MAI7CL,GAAU,CAACA,EAAOK,CAAI,EAAG,OAE7B,KAAM,CAAE,YAAAC,CAAY,EAAID,EAGxB,GACE,EAAEC,EAAY,cAAgBrH,IAC9B,EAAEqH,EAAY,WAAatH,IAC3B,CAAC8G,GACD,CAACC,EAED,OAGF,MAAMQ,EAAY,CAChBF,EAAK,iBACL,IAAIA,EAAK,YAAY,YAAc,IAAI,IAAKjB,GAC1CvG,EAAK,KAAKwH,EAAK,iBAAkB,KAAMjB,CAAI,CAC7C,CACF,EAEMtD,EAAU,MAAMI,EAAWqE,EAAW/G,EAAK,CAC/C,cAAe8G,EAAY,cAAgBrH,KAAkB,GAC7D,UAAWqH,EAAY,WAAatH,CACtC,CAAC,EAED,GAAI8C,EAAQ,SAAW,EAAG,OAEtBgE,IACFO,EAAK,KAAK,IAAI,YAAcvE,EAAQA,EAAQ,OAAS,CAAC,EAAE,MAGtDiE,IACFM,EAAK,KAAK,IAAI,YAAcvE,EAAQ,CAAC,EAAE,MAGzC,MAAM0E,EAAsB1C,EAAc7E,CAAY,EAClDA,EACA,CAAA,EAcJ,IAZIqH,EAAY,cAAgBrH,KAC9BuH,EAAoB,YAAcP,EAClCI,EAAK,KAAK,IAAI,aAAeZ,EAC3B3D,EACAkD,EACAwB,EACA,MAAM,QAAQF,EAAY,YAAY,EAClCA,EAAY,aACZ,CAAA,CACN,GAGEA,EAAY,WAAatH,EAAW,CACtC,MAAM6E,EAAmBC,EAAc9E,CAAS,EAAIA,EAAY,CAAA,EAEhEqH,EAAK,KAAK,IAAI,UAAY3B,EACxB3F,EACA+C,EACA+B,EACA2C,EAAoB,MAAQ,CAAA,CAC9B,CACF,CACF,EAGA,cAAe,IAAM,CACnBzH,EAAI,MAAM,QAASsH,GAAS,CAC1B,OAAOA,EAAK,YAAY,UAC1B,CAAC,CACH,EAEA,iBAAkB,IAChBvH,GAAwBC,EAAK,CAAE,UAAAC,EAAW,aAAAC,CAAa,CAAC,CAC5D,CACF"}